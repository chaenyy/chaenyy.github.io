<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>chany</title>
    <link rel="stylesheet" href="css/myPage_style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Black+Han+Sans&family=Do+Hyeon&family=East+Sea+Dokdo&family=Hi+Melody&family=Jua&family=Lato:wght@700&family=Luckiest+Guy&family=Nanum+Brush+Script&family=Nanum+Gothic:wght@400;700;800&family=Nanum+Pen+Script&family=Noto+Sans+KR:wght@100;300;400;500;700;900&family=Racing+Sans+One&family=Roboto+Mono:ital,wght@0,400;1,500&family=Shrikhand&family=Ultra&display=swap" rel="stylesheet">

</head>
<body>
    <header>
        <div class="header">
            <h2 class="logo"><a href="index.html">CHANY</a></h2>
            <nav>
                <ul class="headerMenu">
                    <li><a href="introduce.html">INTRODUCE</a></li>
                    <li><a href="travel.html">TRAVEL</a></li>
                    <li><a href="roadmap.html">ROAD-MAP</a></li>
                </ul>
            </nav>
                <div class="loginMenu">
                    <div class="loginMemberInfo"></div>
                    <div id="loginText" onclick="loginBtn(this);">LOGIN</div>
                    <a href="join.html" id="joinText">JOIN</a>
                </div>
        </div>
    </header>

    <main>
        <div class="content-wrap">
            <h2 class="titleArea">PROFILE</h2>
            <div class="information">
                <div class="informationText"></div>
            </div>
            <h3 class="subTitle">기본정보</h3>
            <table>
                <tbody>
                    <tr>
                        <th>아이디 </th>
                        <td>
                            <span id="userId"></span>
                        </td>
                    </tr>
                    <tr>
                        <th>비밀번호 확인 질문</th>
                        <td>
                            <span id="userPwd_Question"></span>
                        </td>
                    </tr>
                    <tr>
                        <th>비밀번호 확인 답변</th>
                        <td>
                            <span id="userPwd_Answer"></span>
                        </td>
                    </tr>
                    <tr>
                        <th>이름</th>
                        <td>
                            <span id="userName"></span>
                        </td>
                    </tr>
                    <tr>
                        <th>일반전화</th>
                        <td>
                            <span id="phone"></span>
                        </td>
                    </tr>
                    <tr>
                        <th>휴대전화</th>
                        <td>
                            <span id="mobile"></span>
                        </td>
                    </tr>
                    <tr>
                        <th>이메일</th>
                        <td>
                            <span id="userEmail"></span>
                        </td>
                    </tr>
                </tbody>
            </table>
            <div class="goToMain">
                <a href="index.html"><button id="goToMainBtn">메인페이지로</button></a>
            </div>
        </div>
    </main>


    <script>
    // 로그인 시 헤더에 표시
    const loginInfo = () => {
        const loginData = JSON.parse(localStorage.getItem("loginInfo"));
        const loginMemberInfoDiv = document.querySelector(".loginMemberInfo");
        
        if(loginData) {
            if(loginData.permission === 'normal') {
                loginMemberInfoDiv.innerHTML = `<a href='myPage.html'>${loginData.userName}</a>님, 환영합니다!`;
                loginText.innerHTML = `LOGOUT`;
                joinText.innerHTML = '';
            } else if(loginData.permission === 'admin') {
                loginMemberInfoDiv.innerHTML = `<a href='managerPage.html'>매니저 ${loginData.managerId}</a> 계정으로 접속되었습니다.`;
                loginText.innerHTML = `LOGOUT`;
                joinText.innerHTML = '';
            }
        } else {
            loginMemberInfoDiv.innerHTML = '';
            loginText.innerHTML = 'LOGIN';
            joinText.innerHTML = 'JOIN';
        }
    };
    
    loginInfo();

    const loginBtn = (element) => {
        const loginMemberInfoDiv = document.querySelector(".loginMemberInfo");
        
        if(element.innerHTML === 'LOGIN') {
            window.location.href = "login.html";
            return;
        }

        if(element.innerHTML === 'LOGOUT') {
            const flag = confirm("로그아웃 하시겠습니까?");
            if(flag) {
                localStorage.removeItem('loginInfo');
                loginMemberInfoDiv.innerHTML = '';
                loginText.innerHTML = 'LOGIN';
                joinText.innerHTML = 'JOIN';
                window.location.href = 'index.html';
            } else {
                return;
            }
        }
    };

    // 회원 정보 나타내기
    const memberInfoPrint = () => {
        const loginInfo = JSON.parse(localStorage.getItem("loginInfo"));
        const members = JSON.parse(localStorage.getItem("members"));

        const userIdBox = document.querySelector("#userId");
        const userPwdQuestionBox = document.querySelector("#userPwd_Question");
        const userPwdAnswerBox = document.querySelector("#userPwd_Answer");
        const userNameBox = document.querySelector("#userName");
        const userPhoneBox = document.querySelector("#phone");
        const userMobileBox = document.querySelector("#mobile");
        const userEmailBox = document.querySelector("#userEmail");
        const informationText = document.querySelector(".informationText");

        if(loginInfo) {
            if(loginInfo.permission === 'normal') {
                const loginMemberInfo = members.find((member) => {
                    return member.userId == loginInfo.userId;
                });
                const {userId, userPwd_Question, userPwd_Answer, userName, phoneNumber, mobileNumber, userEmail} = loginMemberInfo;
                informationText.innerHTML = `이용해주셔서 감사합니다. <strong>${userName}</strong> 님은 <strong>[${loginInfo.permission}]</strong> 회원이십니다.`;
                userIdBox.innerHTML = userId;
                userPwdQuestionBox.innerHTML = userPwd_Question;
                userPwdAnswerBox.innerHTML = userPwd_Answer;
                userNameBox.innerHTML = userName;
                userPhoneBox.innerHTML = phoneNumber;
                userMobileBox.innerHTML = mobileNumber;
                userEmailBox.innerHTML = userEmail;
            }
        } else return;
    };

    memberInfoPrint();
    </script>
</body>
</html>